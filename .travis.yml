sudo: required
dist: trusty
services:
  - 'docker'
  
addons:
  sonarcloud:
    organization: "restaurante"
    token:
      secure: "Wo87caoLaf+nWM6Jz0A5uRe6UYdYR1i/uej2RL5PB2BkXl60b5bb9KxN2K8AQSEyZfGPo6CNPPDOYb07JVCutPO/1VSSM21iF+3XdCV4yNhNweFc7gzhS8Nv/dZLK1gjRHj8r0DKSrVp13S7w7FsmJjVGQmPOYdr9rBp4BaURovUse9oH6P6sQczoPDfeECxKjX+5tVkGH8PvOBqbjg1oHxQuIosaSoQW7sr4rFa7Iud7xPmMRIsOTAVlFxRIjl+bYSOPkuHfJdHMq/seLHNgwhAc9SAEHGzTq+35a2NXJ8KE+FJTl3yKUHXczKledBIw2mJlXiaWPZphnLUFa6CRKToJvYn3NJISIWgAqM2eekW5XJIrVeE4IQdy8Q3TaD2Db/N4yk5INSiinYvQ7LIQfpp/I6KfVCSRXC5LFSJCM0s55GGkEfuN9m5y86ZG6lz4qQ+t+wsFi4gti8XctJSZqLtz1ovfrLC+PwPDVwIBImBcfo1cONDP/CZg75Car13GTypXh+rDRhnftEOAtzU4qGjzmoYCwKQZDR2V8Uf+/xpDnazNewaWEV5KvoqVbux3/L5os/Rl2LwbcAdD0qXf/xNOC8S4jLUcXYx/ndnaDvC1hEaN1GMpKP61Z8P/RoDclRjZgn721f5c292dkyt6NFzApQbuuq7Kk7iVBNMdXU="


before_install:
  - chmod +x .travis/main.sh
  - ./.travis/main.sh

before_script:
  - 'docker-compose version'

script:
  - make test
  - make image

after_success:
  - if [[ "$TRAVIS_BRANCH" == "master" ]]; then
      docker login -u $DOCKER_USERNAME -p $DOCKER_PASSWORD ;
      make push-image ;
    fi

# don't notify me when things fail

notifications:
  email: true